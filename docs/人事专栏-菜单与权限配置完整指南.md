# 人事专栏 & 基础设施 — 菜单与权限配置完整指南

> 基于若依 RuoYi-Vue 框架，说明目录、菜单、按钮的细化配置，以及查看/增删改等权限的分离方式。

---

## 一、若依菜单类型说明

若依系统中，菜单分为三种类型，形成「目录 → 菜单 → 按钮」的层级结构：

| 类型 | 说明 | 是否显示在侧边栏 | 用途 |
|------|------|------------------|------|
| **目录** | 一级分组 | 是 | 将多个菜单归类，如「人事专栏」「基础设施」 |
| **菜单** | 可点击进入的页面 | 是 | 对应具体页面路由，如「排班规则」「花名册」 |
| **按钮** | 页面内的操作权限 | 否（通常隐藏） | 控制页面内按钮显示，如「新增」「修改」「删除」 |

**权限分离原则**：
- **查看（query）**：控制能否进入页面、调用列表/详情接口
- **增删改（update/create/delete）**：控制新增、修改、删除按钮及对应接口
- **导出（export）**：控制导出按钮及导出接口
- **特殊操作**：如「生成排班」「发起结算」「查看身份证」等，单独配置

---

## 二、权限标识一览（完整）

以下为开发指南 5.1 节中的权限标识，用于菜单配置的「权限字符」字段。

### 2.1 考勤模块

| 模块 | 操作 | 权限标识 | 对应前端 |
|------|------|----------|----------|
| 排班规则 | 查看 | `system:attendance-rule:query` | 进入页面、列表、详情 |
| 排班规则 | 新增/编辑/删除 | `system:attendance-rule:update` | 新增、修改、删除按钮 |
| 法定节假日 | 查看 | `system:holiday:query` | 进入页面、列表、详情 |
| 法定节假日 | 新增/编辑/删除 | `system:holiday:update` | 新增、修改、删除按钮 |
| 考勤排班 | 查看 | `system:attendance-schedule:query` | 进入页面、列表 |
| 考勤排班 | 手动调整 | `system:attendance-schedule:update` | 生成排班、调班按钮 |
| 考勤排班 | 导出 | `system:attendance-schedule:export` | 导出按钮 |
| 打卡记录 | 查看 | `system:attendance-schedule:query` | 进入页面、列表（与排班共用） |
| 打卡 | 本人打卡 | `system:attendance-record:clock` | 首页/个人中心签到、签退按钮 |

### 2.2 薪资模块

| 模块 | 操作 | 权限标识 | 对应前端 |
|------|------|----------|----------|
| 薪资配置 | 查看 | `system:salary-config:query` | 进入页面 |
| 薪资配置 | 编辑 | `system:salary-config:update` | 保存配置按钮 |
| 员工薪资档案 | 查看 | `system:employee-salary:query` | 进入页面、列表 |
| 员工薪资档案 | 新增/编辑 | `system:employee-salary:update` | 新增、修改按钮 |
| 月度薪资 | 查看 | `system:salary-monthly:query` | 进入页面、列表、详情 |
| 月度薪资 | 发起/确认结算 | `system:salary-monthly:update` | 发起结算、确认、编辑按钮 |
| 月度薪资 | 导出 | `system:salary-monthly:export` | 导出按钮 |

### 2.3 花名册模块

| 模块 | 操作 | 权限标识 | 对应前端 |
|------|------|----------|----------|
| 花名册 | 查看 | `system:hr-employee:query` | 进入页面、列表、详情 |
| 花名册 | 新增/编辑/删除 | `system:hr-employee:update` | 新增、修改、删除按钮 |
| 花名册 | 查看身份证等敏感字段 | `system:hr-employee:sensitive` | 表单中身份证字段显示 |
| 花名册 | 导出 | `system:hr-employee:export` | 导出按钮 |

### 2.4 基础设施模块

| 模块 | 操作 | 权限标识 | 对应前端 |
|------|------|----------|----------|
| 在线文档 | 查看 | `infra:doc:query` | 进入页面、分类树、文档列表、预览 |
| 在线文档 | 管理 | `infra:doc:update` | 分类增删改、文档增删改按钮 |
| 合同管理 | 查看 | `infra:contract:query` | 进入页面、列表、详情 |
| 合同管理 | 新增/编辑/删除 | `infra:contract:update` | 新增、修改、删除按钮 |
| 合同管理 | 导出 | `infra:contract:export` | 导出按钮 |

---

## 三、菜单配置完整清单

在 **系统管理 → 菜单管理** 中，按以下结构逐条新增。

### 3.1 人事专栏（目录）

| 菜单名称 | 菜单类型 | 路由地址 | 图标 | 排序 |
|----------|----------|----------|------|------|
| 人事专栏 | 目录 | hr | 自选（如 ep:user） | 按需 |

**说明**：无权限字符，作为一级分组。

---

### 3.2 排班规则（菜单 + 按钮）

**父菜单**：人事专栏

| 菜单名称 | 菜单类型 | 路由地址 | 组件路径 | 权限字符 | 显示状态 |
|----------|----------|----------|----------|----------|----------|
| 排班规则 | 菜单 | rule | hr/attendance/rule/index | system:attendance-rule:query | 显示 |
| 新增排班规则 | 按钮 | - | - | system:attendance-rule:update | 隐藏 |
| 修改排班规则 | 按钮 | - | - | system:attendance-rule:update | 隐藏 |
| 删除排班规则 | 按钮 | - | - | system:attendance-rule:update | 隐藏 |

**权限分离**：有 `query` 可进入页面；有 `update` 才显示新增/修改/删除按钮。

---

### 3.3 法定节假日（菜单 + 按钮）

**父菜单**：人事专栏

| 菜单名称 | 菜单类型 | 路由地址 | 组件路径 | 权限字符 | 显示状态 |
|----------|----------|----------|----------|----------|----------|
| 法定节假日 | 菜单 | holiday | hr/attendance/holiday/index | system:holiday:query | 显示 |
| 新增节假日 | 按钮 | - | - | system:holiday:update | 隐藏 |
| 修改节假日 | 按钮 | - | - | system:holiday:update | 隐藏 |
| 删除节假日 | 按钮 | - | - | system:holiday:update | 隐藏 |

---

### 3.4 考勤排班（菜单 + 按钮）

**父菜单**：人事专栏

| 菜单名称 | 菜单类型 | 路由地址 | 组件路径 | 权限字符 | 显示状态 |
|----------|----------|----------|----------|----------|----------|
| 考勤排班 | 菜单 | schedule | hr/attendance/schedule/index | system:attendance-schedule:query | 显示 |
| 生成排班 | 按钮 | - | - | system:attendance-schedule:update | 隐藏 |
| 临时调班 | 按钮 | - | - | system:attendance-schedule:update | 隐藏 |
| 导出排班 | 按钮 | - | - | system:attendance-schedule:export | 隐藏 |

---

### 3.5 打卡记录（菜单）

**父菜单**：人事专栏

| 菜单名称 | 菜单类型 | 路由地址 | 组件路径 | 权限字符 | 显示状态 |
|----------|----------|----------|----------|----------|----------|
| 打卡记录 | 菜单 | record | hr/attendance/record/index | system:attendance-schedule:query | 显示 |

**说明**：仅查看，无增删改按钮，与考勤排班共用 query 权限。

---

### 3.6 薪资配置（菜单 + 按钮）

**父菜单**：人事专栏

| 菜单名称 | 菜单类型 | 路由地址 | 组件路径 | 权限字符 | 显示状态 |
|----------|----------|----------|----------|----------|----------|
| 薪资配置 | 菜单 | config | hr/salary/config/index | system:salary-config:query | 显示 |
| 保存配置 | 按钮 | - | - | system:salary-config:update | 隐藏 |

---

### 3.7 员工薪资档案（菜单 + 按钮）

**父菜单**：人事专栏

| 菜单名称 | 菜单类型 | 路由地址 | 组件路径 | 权限字符 | 显示状态 |
|----------|----------|----------|----------|----------|----------|
| 员工薪资档案 | 菜单 | employee | hr/salary/employee/index | system:employee-salary:query | 显示 |
| 新增薪资档案 | 按钮 | - | - | system:employee-salary:update | 隐藏 |
| 修改薪资档案 | 按钮 | - | - | system:employee-salary:update | 隐藏 |

---

### 3.8 月度薪资（菜单 + 按钮）

**父菜单**：人事专栏

| 菜单名称 | 菜单类型 | 路由地址 | 组件路径 | 权限字符 | 显示状态 |
|----------|----------|----------|----------|----------|----------|
| 月度薪资 | 菜单 | monthly | hr/salary/monthly/index | system:salary-monthly:query | 显示 |
| 发起结算 | 按钮 | - | - | system:salary-monthly:update | 隐藏 |
| 批量确认 | 按钮 | - | - | system:salary-monthly:update | 隐藏 |
| 确认薪资单 | 按钮 | - | - | system:salary-monthly:update | 隐藏 |
| 编辑薪资单 | 按钮 | - | - | system:salary-monthly:update | 隐藏 |
| 导出月度薪资 | 按钮 | - | - | system:salary-monthly:export | 隐藏 |

---

### 3.9 花名册（菜单 + 按钮）

**父菜单**：人事专栏

| 菜单名称 | 菜单类型 | 路由地址 | 组件路径 | 权限字符 | 显示状态 |
|----------|----------|----------|----------|----------|----------|
| 花名册 | 菜单 | employee | hr/employee/index | system:hr-employee:query | 显示 |
| 新增员工 | 按钮 | - | - | system:hr-employee:update | 隐藏 |
| 修改员工 | 按钮 | - | - | system:hr-employee:update | 隐藏 |
| 删除员工 | 按钮 | - | - | system:hr-employee:update | 隐藏 |
| 导出花名册 | 按钮 | - | - | system:hr-employee:export | 隐藏 |
| 查看身份证 | 按钮 | - | - | system:hr-employee:sensitive | 隐藏 |

**说明**：`sensitive` 控制表单中身份证号是否明文显示，无此权限则脱敏。

---

### 3.10 在线文档（菜单 + 按钮）

**父菜单**：基础设施（若已有该目录则选其为父菜单）

| 菜单名称 | 菜单类型 | 路由地址 | 组件路径 | 权限字符 | 显示状态 |
|----------|----------|----------|----------|----------|----------|
| 在线文档 | 菜单 | doc | infra/doc/list/index | infra:doc:query | 显示 |
| 新增分类 | 按钮 | - | - | infra:doc:update | 隐藏 |
| 编辑分类 | 按钮 | - | - | infra:doc:update | 隐藏 |
| 删除分类 | 按钮 | - | - | infra:doc:update | 隐藏 |
| 新增文档 | 按钮 | - | - | infra:doc:update | 隐藏 |
| 修改文档 | 按钮 | - | - | infra:doc:update | 隐藏 |
| 删除文档 | 按钮 | - | - | infra:doc:update | 隐藏 |

---

### 3.11 合同管理（菜单 + 按钮）

**父菜单**：基础设施

| 菜单名称 | 菜单类型 | 路由地址 | 组件路径 | 权限字符 | 显示状态 |
|----------|----------|----------|----------|----------|----------|
| 合同管理 | 菜单 | contract | infra/contract/index | infra:contract:query | 显示 |
| 新增合同 | 按钮 | - | - | infra:contract:update | 隐藏 |
| 修改合同 | 按钮 | - | - | infra:contract:update | 隐藏 |
| 删除合同 | 按钮 | - | - | infra:contract:update | 隐藏 |
| 导出合同 | 按钮 | - | - | infra:contract:export | 隐藏 |

---

### 3.12 打卡（按钮，用于首页/个人中心）

**说明**：打卡不单独建菜单，但需在角色中分配，才能使用首页和个人中心的签到/签退。

| 菜单名称 | 菜单类型 | 父菜单 | 权限字符 | 显示状态 |
|----------|----------|--------|----------|----------|
| 签到签退 | 按钮 | 可挂在「考勤排班」或「打卡记录」下 | system:attendance-record:clock | 隐藏 |

**建议**：将 `system:attendance-record:clock` 挂在「考勤排班」或「打卡记录」下，分配给需要打卡的角色（如全员）。

---

## 四、个人中心聚合面板

### 4.1 访问方式

个人中心为**固定路由**，不通过菜单管理配置：

- **路由**：`/user/profile`
- **入口**：右上角头像 → 个人中心
- **工作台 Tab**：个人中心内的「工作台」Tab 展示聚合面板

### 4.2 聚合面板内容

| 卡片 | 数据来源 | 说明 |
|------|----------|------|
| 今日打卡 | `/system/personal-center/clock-in`、`clock-out` | 签到/签退，需 `system:attendance-record:clock` |
| 本月考勤 | `/system/personal-center/panel` | 应出勤/实出勤/迟到/缺勤 + 日历 |
| 最新薪资单 | 同上 | 仅展示已确认/已发放 |
| 员工档案 | 同上 | 本人档案 |
| 我的合同 | 同上 | 本人负责的合同 |

### 4.3 权限说明

- **panel 接口**：仅需登录，无需额外权限
- **打卡按钮**：需分配 `system:attendance-record:clock`

---

## 五、角色分配建议

在 **系统管理 → 角色管理** 中，按角色勾选菜单和按钮：

| 角色 | 建议分配的菜单/权限 |
|------|----------------------|
| 超级管理员 | 全部（*:*:* 或勾选全部） |
| HR/人事 | 人事专栏全部 + 打卡 |
| 财务 | 薪资配置、员工薪资档案、月度薪资 + 打卡 |
| 部门负责人 | 考勤排班、打卡记录（查看）、花名册（查看）、打卡 |
| 普通员工 | 打卡、个人中心工作台 |

---

## 六、配置要点总结

1. **查看与增删改分离**：`query` 控制进入页面，`update` 控制增删改按钮。
2. **按钮类型菜单**：类型选「按钮」，父菜单选对应页面，勾选「隐藏」。
3. **权限字符一致**：菜单中的权限字符需与前端 `v-hasPermi`、后端 `@PreAuthorize` 完全一致。
4. **导出单独配置**：`export` 权限单独控制导出按钮。
5. **敏感字段**：花名册的 `sensitive` 控制身份证明文显示。

---

## 七、前端 v-hasPermi 对应关系

| 权限标识 | 前端使用位置 |
|----------|--------------|
| system:attendance-rule:query | 排班规则菜单显示 |
| system:attendance-rule:update | 新增、修改、删除按钮 |
| system:holiday:query | 法定节假日菜单显示 |
| system:holiday:update | 新增、修改、删除按钮 |
| system:attendance-schedule:query | 考勤排班、打卡记录菜单显示 |
| system:attendance-schedule:update | 生成排班、调班按钮 |
| system:attendance-schedule:export | 导出按钮（若有） |
| system:attendance-record:clock | 首页打卡、个人中心签到/签退 |
| system:salary-config:query | 薪资配置菜单显示 |
| system:salary-config:update | 保存配置按钮 |
| system:employee-salary:query | 员工薪资档案菜单显示 |
| system:employee-salary:update | 新增、修改按钮 |
| system:salary-monthly:query | 月度薪资菜单显示 |
| system:salary-monthly:update | 发起结算、确认、编辑按钮 |
| system:salary-monthly:export | 导出按钮 |
| system:hr-employee:query | 花名册菜单显示 |
| system:hr-employee:update | 新增、修改、删除按钮 |
| system:hr-employee:sensitive | 表单身份证字段 |
| system:hr-employee:export | 导出按钮 |
| infra:doc:query | 在线文档菜单显示 |
| infra:doc:update | 分类/文档增删改按钮 |
| infra:contract:query | 合同管理菜单显示 |
| infra:contract:update | 新增、修改、删除按钮 |
| infra:contract:export | 导出按钮 |
